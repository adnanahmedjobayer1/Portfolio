// src/components/Projects.js

import React, { useState, useEffect } from 'react';
import { Container, Row, Col, Button, Modal, Carousel } from 'react-bootstrap';
import { Fade } from 'react-awesome-reveal';
import { FaLink, FaGithub } from 'react-icons/fa';

// আপনার প্রজেক্টের ছবিগুলো `src/assets/projects/` ফোল্ডারে রাখুন
import projImg1 from '../images/project.png';
import projImg2 from '../images/project1.png';
import projImg3 from '../images/project.png';
import projImg4 from '../images/project1.png';
// --- প্রজেক্ট ডেটা ---
const projectsData = [
  {
    id: 1,
    title: 'ই-কমার্স প্ল্যাটফর্ম',
    shortDescription: 'একটি আধুনিক ও সম্পূর্ণ বৈশিষ্ট্যযুক্ত ই-কমার্স ওয়েবসাইট।',
    detailedDescription: 'এই প্রজেক্টটি MERN স্ট্যাক ব্যবহার করে তৈরি করা হয়েছে। এখানে প্রোডাক্ট ম্যানেজমেন্ট, ইউজার অথেনটিকেশন, পেমেন্ট গেটওয়ে ইন্টিগ্রেশন এবং অ্যাডমিন ড্যাশবোর্ডের মতো ফিচার রয়েছে। ব্যবহারকারীর অভিজ্ঞতাকে সর্বোচ্চ গুরুত্ব দেওয়া হয়েছে।',
    images: [projImg1_1, projImg1_2],
    tags: ['React', 'Node.js', 'MongoDB', 'Express', 'Redux'],
    liveLink: '#',
    githubLink: '#',
    category: 'fullstack',
  },
  {
    id: 2,
    title: 'পার্সোনাল পোর্টফোলিও',
    shortDescription: 'রিঅ্যাক্ট দিয়ে তৈরি একটি সৃজনশীল এবং রেসপন্সিভ পোর্টফোলিও।',
    detailedDescription: 'এটি একটি সিঙ্গেল পেজ অ্যাপ্লিকেশন (SPA) যা React, React-Bootstrap এবং Framer Motion ব্যবহার করে তৈরি। এতে একটি ডার্ক/লাইট থিম, স্মুথ স্ক্রল এবং আকর্ষণীয় অ্যানিমেশন যোগ করা হয়েছে।',
    images: [projImg2_1],
    tags: ['React', 'Bootstrap', 'CSS', 'Framer Motion'],
    liveLink: '#',
    githubLink: '#',
    category: 'frontend',
  },
  {
    id: 3,
    title: 'ব্লগিং অ্যাপ',
    shortDescription: 'Node.js এবং EJS দিয়ে নির্মিত একটি সাধারণ ব্লগিং প্ল্যাটফর্ম।',
    detailedDescription: 'এটি একটি সার্ভার-সাইড রেন্ডারড অ্যাপ্লিকেশন। ব্যবহারকারীরা পোস্ট তৈরি, এডিট এবং ডিলিট করতে পারে। Markdown সাপোর্ট এবং কমেন্টিং সিস্টেমও যোগ করা হয়েছে।',
    images: [projImg3_1],
    tags: ['Node.js', 'EJS', 'MongoDB', 'CSS'],
    liveLink: '#',
    githubLink: '#',
    category: 'backend',
  },
];

const filterCategories = [
  { key: 'all', name: 'সব' },
  { key: 'frontend', name: 'ফ্রন্টএন্ড' },
  { key: 'backend', name: 'ব্যাকএন্ড' },
  { key: 'fullstack', name: 'ফুল-স্ট্যাক' },
];

// --- লোকাল কম্পোনেন্ট: প্রজেক্ট কার্ড ---
const ProjectCard = ({ project, onViewClick }) => (
  <div className="project-card">
    <div className="project-image-container">
      <img src={project.images[0]} alt={project.title} className="project-image" />
    </div>
    <div className="project-details">
      <h5 className="project-title">{project.title}</h5>
      <p className="project-description">{project.shortDescription}</p>
      <div className="project-tags">
        {project.tags.slice(0, 3).map((tag, index) => (
          <span key={index} className="tag">{tag}</span>
        ))}
      </div>
      <Button variant="primary" className="view-project-btn" onClick={() => onViewClick(project)}>
        বিস্তারিত দেখুন
      </Button>
    </div>
  </div>
);

// --- লোকাল কম্পোনেন্ট: প্রজেক্ট মোডাল ---
const ProjectModal = ({ show, onHide, project }) => {
  if (!project) return null;
  const isDarkTheme = document.body.classList.contains('dark-theme');

  return (
    <Modal show={show} onHide={onHide} size="lg" centered dialogClassName="project-modal">
      <Modal.Header closeButton closeVariant={isDarkTheme ? 'white' : 'black'}>
        <Modal.Title className="modal-title-custom">{project.title}</Modal.Title>
      </Modal.Header>
      <Modal.Body>
        <Carousel interval={null}>
          {project.images.map((img, index) => (
            <Carousel.Item key={index}>
              <img className="d-block w-100 modal-image" src={img} alt={`Slide ${index}`} />
            </Carousel.Item>
          ))}
        </Carousel>
        <h5 className="mt-4">ব্যবহৃত প্রযুক্তি:</h5>
        <div className="project-tags modal-tags">
          {project.tags.map((tag, index) => (
            <span key={index} className="tag">{tag}</span>
          ))}
        </div>
        <h5 className="mt-4">বিস্তারিত:</h5>
        <p className="modal-description">{project.detailedDescription}</p>
      </Modal.Body>
      <Modal.Footer>
        <Button variant="outline-secondary" href={project.githubLink} target="_blank">
          <FaGithub className="me-2" /> কোড দেখুন
        </Button>
        <Button variant="primary" href={project.liveLink} target="_blank">
          <FaLink className="me-2" /> লাইভ ডেমো
        </Button>
      </Modal.Footer>
    </Modal>
  );
};


// --- মূল কম্পোনেন্ট: Projects ---
function Projects() {
  const [activeFilter, setActiveFilter] = useState('all');
  const [filteredProjects, setFilteredProjects] = useState(projectsData);
  const [showModal, setShowModal] = useState(false);
  const [selectedProject, setSelectedProject] = useState(null);

  useEffect(() => {
    if (activeFilter === 'all') {
      setFilteredProjects(projectsData);
    } else {
      setFilteredProjects(projectsData.filter((p) => p.category === activeFilter));
    }
  }, [activeFilter]);

  const handleShowModal = (project) => {
    setSelectedProject(project);
    setShowModal(true);
  };

  const handleCloseModal = () => setShowModal(false);

  return (
    <>
      <section id="projects" className="projects-section">
        <Container>
          <Fade direction="up" triggerOnce>
            <h2 className="section-title text-center mb-5">আমার নির্বাচিত কাজ</h2>
          </Fade>
          <div className="filter-buttons text-center mb-5">
            {filterCategories.map((cat) => (
              <button
                key={cat.key}
                className={`filter-btn ${activeFilter === cat.key ? 'active' : ''}`}
                onClick={() => setActiveFilter(cat.key)}
              >
                {cat.name}
              </button>
            ))}
          </div>
          <Row>
            {filteredProjects.map((project) => (
              <Col lg={4} md={6} className="mb-4" key={project.id}>
                <Fade direction="up" triggerOnce>
                  <ProjectCard project={project} onViewClick={handleShowModal} />
                </Fade>
              </Col>
            ))}
          </Row>
        </Container>
      </section>

      <ProjectModal
        show={showModal}
        onHide={handleCloseModal}
        project={selectedProject}
      />
    </>
  );
}

export default Projects;